#
# Order Action: Issuer to signal to the smart contract that the tokens that a particular public address(es) owns are to be confiscated, frozen, thawed or reconciled.
#

code: E1

metadata:
  name: Order
  label: Order Action
  description: "Order Action -  Issuer to signal to the smart contract that the tokens that a particular public address(es) owns are to be confiscated, frozen, thawed or reconciled."
  validation: AssetCreation
  rejection: Rejection

rules:
  fee:
  inputs:
    - name: Issuer
      label: "Issuer's Public Address"
      comments:

  outputs:
    - name: Contract
      label: Contract Public Address
      comments:

fields:
  - name: Header
    label: Header
    description: "Common header data for all messages"
    type: Header
    notes: "Common header data for all messages."

  - name: TextEncoding
    label: Text Encoding
    description: " 0 = ASCII, 1 = UTF-8, 2 = UTF-16, 3 = Unicode.  Encoding applies to all 'text' data types. All 'string' types will always be encoded with ASCII.  Where string is selected, all fields will be ASCII."
    type: uint8
    size: 1
    example_hex: 00
    example_value: "0"
    notes: "Can be changed by Issuer or Operator at their discretion."

  - name: AssetType
    label: Asset Type
    description: "eg. Share, Bond, Ticket"
    type: string
    size: 3
    example_hex: 534843
    example_value: "SHC"
    notes: ""

  - name: AssetID
    label: Asset ID
    description: "Randomly generated base58 string.  Each Asset ID should be unique.  However, a Asset ID is always linked to a Contract that is identified by the public address of the Contract wallet. The Asset Type can be the leading bytes - a convention - to make it easy to identify that it is a token by humans."
    type: string
    size: 32
    example_hex: 61706d3271737a6e686b7332337a386438337534317338303139687972693369
    example_value: "apm2qsznhks23z8d83u41s8019hyri3i"
    notes: ""

  - name: ComplianceAction
    label: Compliance Action
    description: "Freeze (F), Thaw (T), Confiscate (C), Reconciliation (R)"
    type: string
    size: 1
    example_hex: 46
    example_value: "F"
    notes: ""

  - name: TargetAddressCount
    label: Number of Target Addresses
    description: "0 - 65,535"
    type: uint16
    size: 2
    example_hex: 0000
    example_value: 0
    notes: ""

  - name: TargetAddresses
    label: Target Addresses
    type: TargetAddress[]

  - name: DepositAddress
    label: Deposit Address
    description: "Length 1-255 bytes. The public address for confiscated tokens to be deposited in.  Null for Freeze, Thaw, actions. For Reconciliation actions the deposit address is who receives bitcoin."
    type: nvarchar8
    example_hex: 2231377a4157616269706355486e35585039773847456333504b764735625947424d65
    example_value: "17zAWabipcUHn5XP9w8GEc3PKvG5bYGBMe"
    notes: "Eventually the supporting evidence/explanation can be supported by a Subfield that has the public address (and a signed message) owned by a legal authority for ID verification/certification purposes."

  - name: EnforcementAuthorityName
    label: Enforcement Authority Name
    description: "Length 0-255 bytes. Enforcement Authority Name (eg. Queensland Police Service, Tokenized, etc.)"
    type: nvarchar8
    example_hex: 2453757072656d6520616e6420446973747269637420436f75727473204272697362616e65
    example_value: "Supreme and District Courts Brisbane"
    notes: ""

  - name: SigAlgoAddressList
    label: Signature Algorithm for Address List
    description: "0 = No Registry-signed Message, 1 = ECDSA+secp256k1"
    type: uint8
    size: 1
    example_hex: 01
    example_value: 1
    notes: ""

  - name: EnforcementAuthorityPublicKey
    label: Enforcement Authority Public Key
    description: "Length 0-255 bytes. Public Key associated with the Enforcement Authority"
    type: nvarchar8
    example_hex: 00
    example_value: ""
    notes: ""

  - name: OrderSignature
    label: Enforcement Authority Order Signature
    description: "Length 0-255 bytes. Signature for a message that lists out the target addresses and deposit address. Signature of (Contract Address, Asset Code, Compliance Action, Supporting Evidence Hash, Time Out Expiration, TargetAddress1, TargetAddress1Qty, TargetAddressX, TargetAddressXQty,...,DepositAddress)"
    type: nvarchar8
    example_hex: 00
    example_value: ""
    notes: ""

  - name: SupportingEvidenceHash
    label: Supporting Evidence Hash
    description: "SHA-256: warrant, court order, etc."
    type: sha256
    size: 32
    example_hex: c236f77c7abd7249489e7d2bb6c7e46ba3f4095956e78a584af753ece56cf6d1
    example_value: "c236f77c7abd7249489e7d2bb6c7e46ba3f4095956e78a584af753ece56cf6d1"
    notes: ""

  - name: RefTxnID
    label: Ref Txn ID
    description: "The settlement action that was dropped from the network.  Not applicable for Freeze, Thaw, and Confiscation orders.  Only applicable for reconcilliation actions.  No subfield when F, T, R is selected as the Compliance Action subfield."
    type: sha256
    size: 32
    example_hex: f3318be9fb3f73e53b29868beae46b42911c2116f979a5d3284face90746cb37
    example_value: "f3318be9fb3f73e53b29868beae46b42911c2116f979a5d3284face90746cb37"
    notes: ""

  - name: FreezePeriod
    label: Freeze Period
    description: "Used for a 'time out'.  Tokens are automatically unfrozen after the expiration timestamp without requiring a Thaw Action. Null value for Thaw, Confiscation and Reconciallitaion orders."
    type: time
    size: 8
    example_hex: 00000166550ce380
    example_value: "Tue Oct 09 2018 05:00:00 GMT+1000 (AEST)"
    notes: ""

  - name: Message
    label: Message Period
    description: "Length 0 - 65,535 bytes. 0 is valid. Explanation. No personal information to be given away.  Privacy to be respected as much as possible."
    type: nvarchar16
    example_hex: 0023536f7272792c206275742074686520636f757274206f72646572206d616465206d652e
    example_value: "Sorry, but the court order made me."
    notes: ""
