# 
# Contract Formation Action:  This txn is created by the Contract (smart contract/off-chain agent/token contract) upon receipt of a valid Contract Offer Action from the issuer.  The Smart Contract will execute on a server controlled by the Issuer. or a Smart Contract Operator on their behalf .
# 

code: C2

metadata:
  name: ContractFormation
  label: Contract Formation Action
  description: "Contract Formation Action -   This txn is created by the Contract (smart contract/off-chain agent/token contract) upon receipt of a valid Contract Offer Action from the issuer.  The Smart Contract will execute on a server controlled by the Issuer. or a Smart Contract Operator on their behalf ."
  validation: AssetCreation
  rejection: Rejection

rules:
  fee:
  inputs:
    - name: 
      label: Contract Public Address
      comments: 

  outputs:
    - name: 
      label: Contract Public Address
      comments: 

    - name: 
      label: Issuer's Public Address
      comments: Change (Required, minimum 546). Will be the new issuer's address if a CA was performed that changed the issuer's address. 

    - name: 
      label: Contract Fee Address
      comments: Contract Operator's Fee

    - name: 
      label: OP_RETURN (Contract Formation Action)
      comments: Only one Tokenized action (excluding Message actions) per txn.  Action payload is always the last index of the txn outputs.  There is no limit to the number of M1 (message) actions per txn. 

    - name: 
      label: Miner's Fee
      comments: ~550-1000 Bytes to account for return data and txn data.

fields:
  - name: PUSHDATAINSTRUCTION
    label: Push Data
    description: "PUSHDATA 13 bytes for Protocol Identifer"
    type: opcode
    size: 1
    example hex: 0d
    example value: "13"
    notes: "Cannot be changed by issuer, operator, or smart contract."

  - name: ProtocolID
    label: Protocol Identifier
    description: "Tokenized ID Prefix.  tokenized.com"
    type: string
    size: 13
    example hex: 746f6b656e697a65642e636f6d
    example value: "tokenized.com"
    notes: ""

  - name: OP_PUSHDATA
    label: Push Data
    description: "PACKET LENGTH, PUSHDATA1 (76), PUSHDATA2 (77), or PUSHDATA4 (78) depending on total size of action payload."
    type: opcode
    size: 1
    example hex: 4d
    example value: "77"
    notes: "Cannot be changed by issuer, operator or smart contract."

  - name: LenActionPayload
    label: Length of Action Payload
    description: "Length of the action message (0 - 65,535 bytes). 0 if pushdata length <76B, 1 byte if PUSHDATA1 is used, 2 bytes if PUSHDATA2 and 4 bytes if PUSHDATA4."
    type: pushdata_length
    size: 2
    example hex: 198
    example value: "408"
    notes: "Depends on Action Payload"

  - name: Version
    label: Version
    description: "255 reserved for additional versions. Tokenized protocol versioning."
    type: uint8
    size: 1
    example hex: 0
    example value: "0"
    notes: "Can be changed by Issuer or Operator at their discretion.  Smart Contract will reject if it hasn't been updated to interpret the version."

  - name: ActionPrefix
    label: Action Prefix
    description: "Contract Formation: All Contracts must have a Formation Action to be considered valid.  The Contract Formation Action must be generated by the smart contract from the information specified by the issuer's Contract Offer Action.  The Contract Formation Action is a positive confirmation that the smart contract is operational and that the contractual terms and conditions have been set."
    type: string
    size: 2
    example hex: 4332
    example value: "C2"
    notes: "Cannot be changed by issuer, operator or smart contract."

  - name: TextEncoding
    label: Text Encoding
    description: " 0 = ASCII, 1 = UTF-8, 2 = UTF-16, 3 = Unicode.  Encoding applies to all 'text' data types. All 'string' types will always be encoded with ASCII.  Where string is selected, all fields will be ASCII."
    type: uint8
    size: 1
    example hex: 0
    example value: "0"
    notes: "Can be changed by Issuer or Operator at their discretion."

  - name: Timestamp
    label: Timestamp
    description: "Timestamp of when the smart contract created the Settlement action."
    type: time
    size: 8
    example hex: 0000016331e3c200
    example value: "Sun May 06 2018 06:00:00 GMT+1000 (AEST)"
    notes: "Cannot be changed by issuer, operator. Smart contract controls."

  - name: ContractName
    label: Contract Name
    description: "Can be any unique identifying string, including human readable names for branding/vanity purposes.   [Contract identifier (instance) is the bitcoin public key hash address. If the Public Address is lost, then the issuer will have to reissue the entire contract, Asset definition and tokens with the new public address.]. Smart contracts can be branded and specialized to suit any terms and conditions."
    type: nvarchar8
    size: 30
    example hex: 1d5465736c61202d205368617265686f6c6465722041677265656d656e74
    example value: "Tesla - Shareholder Agreement"
    notes: ""

  - name: ContractFileType
    label: Contract File Type
    description: "1 - SHA-256 Hash, 2 - Markdown file"
    type: uint8
    size: 1
    example hex: 01
    example value: "1"
    notes: "Contract File - Amendments can be restricted to a vote."

  - name: LenContractFile
    label: Length of Contract File
    description: "Max size is the max transaction size - other data in the txn.  "
    type: uint32
    size: 4
    example hex: 00000020
    example value: "32"
    notes: ""

  - name: ContractFile
    label: Contract File
    description: "SHA-256 hash of the Contract file specific to the smart contract and relevant Assets.  Legal and technical information. (eg. pdf)"
    type: string
    size: 32
    example hex: 63323336663737633761626437323439343839653764326262366337653436626133663430393539353665373861353834616637353365636535366366366431
    example value: "c236f77c7abd7249489e7d2bb6c7e46ba3f4095956e78a584af753ece56cf6d1"
    notes: ""

  - name: ContractRevision
    label: Contract Revision
    description: "Counter. Cannot be manually changed by issuer.  Can only be incremented by 1 by SC when CF action is published."
    type: uint64
    size: 8
    example hex: 0000000000000000
    example value: "0"
    notes: "Can't be changed by issuer or smart contract operator."

  - name: GoverningLaw
    label: Governing Law
    description: "5 Letter Code to Identify which governing law the contract will adhere to.  Disputes are to be settled by this law in the jurisdiction specified below. Private dispute resolution organizations can be used as well.  A custom code just needs to be defined."
    type: string
    size: 5
    example hex: 5553410000
    example value: "USA"
    notes: "Governing Law - Amendments can be restricted to a vote."

  - name: Jurisdiction
    label: Jurisdiction
    description: "Legal proceedings/arbitration will take place using the specified Governing Law in this location."
    type: string
    size: 5
    example hex: 55532d4341
    example value: "US-CA"
    notes: "Jurisdiction - Amendments can be restricted to a vote."

  - name: ContractExpiration
    label: Contract Expiration
    description: "All actions related to the contract will cease to work after this timestamp. The smart contract will stop running.  This will allow many token use cases to be able to calculate smart contract running costs. Eg. an issuer is creating tickets for an event on the 5th of June 2018.  The smart contract will facilitate exchange and send transactions up until the 6th of June.  Wallets can use this to forget tokens that are no longer valid - or at least store them in an 'Expired' folder."
    type: time
    size: 8
    example hex: 00000163400d3f00
    example value: "Wed May 09 2018 00:00:00 GMT+1000 (AEST)"
    notes: "Contract Expiration - Amendments can be restricted to a vote."

  - name: ContractURI
    label: Contract URI
    description: "Length 0-255 bytes.  0 is valid. Points to an information page that also has a copy of the Contract.  Anyone can go to the website to have a look at the price/token, information about the Issuer (company), information about the Asset, legal information, etc.  There will also be a way for Token Owners to vote on this page and contact details with the Issuer/tokenized companies. Could be a IPv6/IPv4, an IPFS address (hash) or txn-id for on chain information or even a public address (DNS)."
    type: nvarchar8
    size: 53
    example hex: 3468747470733a2f2f746f6b656e697a65642e636f6d2f436f6e74726163742f3371656f534367374a6d66536e4a65734a466f6a6a
    example value: "https://tokenized.com/Contract/3qeoSCg7JmfSnJesJFojj"
    notes: ""

  - name: IssuerName
    label: Issuer Name
    description: "Length 0-255 bytes. 0 is not valid. Issuing entity (company, organization, individual).  Can be any unique identifying string, including human readable names for branding/vanity purposes. "
    type: nvarchar8
    size: 11
    example hex: 0a5465736c6120496e632e
    example value: "Tesla Inc."
    notes: ""

  - name: IssuerType
    label: Issuer Type
    description: "P - Public Company Limited by Shares, C - Private Company Limited by Shares, I - Individual, L - Limited Partnership, U -Unlimited Partnership, T - Sole Proprietorship, S - Statutory Company, O - Non-Profit Organization, N - Nation State, G - Government Agency, U - Unit Trust, D - Discretionary Trust.  Found in 'Entities' (Specification/Resources)."
    type: string
    size: 1
    example hex: 50
    example value: "P"
    notes: "Issuer Type - Amendments can be restricted to a vote."

  - name: ContractOperatorID
    label: Contract Operator ID
    description: "Length 0-255 bytes. 0 is valid. Smart Contract Operator identifier. Can be any unique identifying string, including human readable names for branding/vanity purposes. Can also be null or the Issuer."
    type: nvarchar8
    size: 10
    example hex: 09546f6b656e697a6564
    example value: "Tokenized"
    notes: ""

  - name: ContractAuthFlags
    label: Contract Authorization Flags
    description: "Authorization Flags aka Terms and Conditions that the smart contract can enforce.  Other terms and conditions that are out of the smart contract's control are listed in the actual Contract File."
    type: bin[var]
    size: 16
    example hex: 492492496db6db6d249b6db6db6db6c0
    example value: "010010010010010010010010010010010110110110110110110110110110110100100100100110110110110110110110110110110110110110110110110000000"
    notes: "Contract Flags - Amendments can be restricted to a vote.  Specified in the Voting System."

  - name: VotingSystemCount
    label: Number of Voting Systems
    description: "0-10 voting systems. If 0, Voting System and associated subfields (InitiativeThreshold, InitiativeThresholdCurrency) will be null. 10 will be upper limit and restricted by the smart contract."
    type: uint8
    size: 1
    example hex: 03
    example value: "3"
    notes: "Voting - Amendments can be restricted to a vote."

  - name: VoteSystemNameX
    label: Vote System Name X
    description: "eg. Special Resolutions, Ordinary Resolutions, Fundamental Matters, General Matters, Directors' Vote, Poll, etc."
    type: nvarchar8
    size: 1
    example hex: 135370656369616c205265736f6c7574696f6e73
    example value: "Special Resolutions"
    notes: ""

  - name: VotingSystemX
    label: Voting System X
    description: "Specifies which subfield is subject to this vote system's control."
    type: bin[var]
    size: 8
    example hex: af592aafd8512810
    example value: "1010111101011001001010101010111111011000010100010010100000010000"
    notes: ""

  - name: VoteMethodX
    label: Vote Method X
    description: "R - Relative Threshold, A - Absolute Threshold, P - Plurality,  (Relative Threshold means the number of counted votes must exceed the threshold % of total ballots cast.  Abstentations/spoiled votes do not detract from the liklihood of a vote passing as they are not included in the denominator.  Absolute Threshold requires the number of ballots counted to exceed the threshold value when compared to the total outstanding tokens.  Abstentations/spoiled votes detract from the liklihood of the vote passing.  For example, in an absolute threshold vote, if the threshold was 50% and 51% of the total outstanding tokens did not vote, then the vote cannot pass.  50% of all tokens would have had to vote for one vote option for the vote to be successful."
    type: string
    size: 1
    example hex: 41
    example value: "A"
    notes: ""

  - name: VoteLogicX
    label: Vote Logic X
    description: "0 - Standard Scoring (+1 * # of tokens owned), 1 - Weighted Scoring (1st choice * Vote Max * # of tokens held, 2nd choice * Vote Max-1 * # of tokens held,..etc.) "
    type: string
    size: 1
    example hex: 30
    example value: "0"
    notes: ""

  - name: ThresholdPercentageX
    label: Threshold Percentage for Vote System X
    description: "1-100 is valid for relative threshold and absolute threshold. (eg. 75 means 75% and greater). 0 & >=101 is invalid and will be rejected by the smart contract.  Only applicable to Relative and Absolute Threshold vote methods.  The Plurality vote method requires no threshold value (NULL), as the successful vote option is simply selected on the basis of highest ballots cast for it."
    type: uint8
    size: 1
    example hex: 00
    example value: "0.75"
    notes: ""

  - name: VoteMultiplierPermittedX
    label: VoteMultiplierPermitted X
    description: "Y - Yes, N - No. Where an asset has a vote multiplier, Y must be selected here for the vote multiplier to count, otherwise votes are simply treated as 1x per token."
    type: string
    size: 1
    example hex: 592f4e
    example value: "Y/N"
    notes: ""

  - name: InitiativeThresholdX
    label: Initiative Threshold for Voting System X
    description: "Token Owners must pay the threshold amount to broadcast a valid Initiative.  If the Initiative action is valid, the smart contract will start a vote. 0 is valid."
    type: float32
    size: 4
    example hex: 42c80000
    example value: "100"
    notes: ""

  - name: InitiativeThreshold CurrencyX
    label: Initiative Threshold Currency for Voting System X
    description: "Currency.  Always paid in BSV or a currency token (CUR) at current market valuations in the currency listed. NULL is valid."
    type: string
    size: 3
    example hex: 415544
    example value: "AUD"
    notes: ""

  - name: RestrictedQtyAssets
    label: Restricted Qty of Assets
    description: "Number of Assets (non-fungible) permitted on this contract. 0 if unlimited which will display an infinity symbol in UI"
    type: uint64
    size: 8
    example hex: 0000000000000001
    example value: "1"
    notes: "Qty of Assets - Amendments can be restricted to a vote."

  - name: ReferendumProposal
    label: Referendum Proposal 
    description: "A Referendum is permitted for Contract-Wide Proposals (outside of smart contract scope)."
    type: string
    size: 1
    example hex: 59
    example value: "Y"
    notes: "General Governance"

  - name: InitiativeProposal
    label: Initiative Proposal
    description: "An initiative is permitted for Contract-Wide Proposals (outside of smart contract scope)."
    type: string
    size: 1
    example hex: 59
    example value: "Y"
    notes: ""

  - name: RegistryCount
    label: Registry Count
    description: "Number of registries (eg. KYC registry/database/whitelist/identity database/etc - managed by a Registrar (oracle)) the smart contract is permitted to interact with. 0-255. 0 is valid (no registry subfields)."
    type: uint8
    size: 1
    example hex: 01
    example value: "1"
    notes: "Registry - Can be restricted to a vote."

  - name: RegistrarXName
    label: Registrar X Name
    description: "Length 0-255 bytes. 0 is valid. Registry X Name (eg. Coinbase, Tokenized, etc.)"
    type: nvarchar8
    size: 10
    example hex: 09546f6b656e697a6564
    example value: "Tokenized"
    notes: ""

  - name: RegistryXURL
    label: Registry X URL
    description: "Length 0-255 bytes. 0 is valid. If applicable: URL for REST/RPC Endpoint"
    type: nvarchar8
    size: 53
    example hex: 34687474703a2f2f72656769737472792e746f6b656e697a65642e636f6d2f6170692f3336353064392f76657273696f6e32303130
    example value: "http://registry.tokenized.com/api/3650d9/version2010"
    notes: ""

  - name: RegistryXPublicKey
    label: Registry X Public Key
    description: "Length 0-255 bytes. 0 is not valid. Registry Public Key (eg. Bitcoin Public key), used to confirm digital signed proofs for transfers.  Can also be the same public address that controls a Tokenized Registry."
    type: nvarchar8
    size: 1
    example hex: 00
    example value: ""
    notes: ""

  - name: IssuerAddress
    label: Issuer Address
    description: "Physical/mailing address. Y/N, N means there is no issuer address."
    type: string
    size: 1
    example hex: 59
    example value: "Y"
    notes: "Issuer Details - Can always be amended by issuer/smart contract operator."

  - name: UnitNumber
    label: Unit Number
    description: "Issuer Address Details (eg. HQ)"
    type: nvarchar8
    size: 2
    example hex: 0132
    example value: "2"
    notes: ""

  - name: BuildingNumber
    label: Building Number
    description: ""
    type: nvarchar8
    size: 6
    example hex: 053133353737
    example value: "13577"
    notes: ""

  - name: Street
    label: Street
    description: ""
    type: nvarchar16
    size: 14
    example hex: 000c466169726d6f6e7420417665
    example value: "Fairmont Ave"
    notes: ""

  - name: SuburbCity
    label: Suburb/City
    description: ""
    type: nvarchar8
    size: 8
    example hex: 07526f62696e6f68
    example value: "Robinoh"
    notes: ""

  - name: TerritoryStateProvinceCode
    label: Territory/State/Province Code
    description: ""
    type: string
    size: 5
    example hex: 4243000000
    example value: "BC"
    notes: ""

  - name: CountryCode
    label: Country Code
    description: ""
    type: string
    size: 3
    example hex: 555341
    example value: "USA"
    notes: ""

  - name: PostalZIPCode
    label: Postal/ZIP Code
    description: ""
    type: string
    size: 12
    example hex: 353032313000000000000000
    example value: "50210"
    notes: ""

  - name: EmailAddress
    label: Email Address
    description: "Address for text-based communication: eg. email address, Bitcoin address"
    type: nvarchar8
    size: 20
    example hex: 136a616d657340746f6b656e697a65642e636f6d
    example value: "james@tokenized.com"
    notes: ""

  - name: PhoneNumber
    label: Phone Number
    description: "Phone Number for Entity. Max acceptable size: 50."
    type: nvarchar8
    size: 11
    example hex: 0a30343438343834383438
    example value: "0448484848"
    notes: ""

  - name: KeyRolesCount
    label: KeyRoles Count
    description: "Number of key roles associated with the issuing entity.  (eg. Directors, etc.) 0-255. 0 is valid."
    type: uint8
    size: 1
    example hex: 01
    example value: "1"
    notes: "Key Roles - Amendments to Chairmain/Director positions can be restricted to a vote.  No restrictions on changing other roles."

  - name: KeyRoleXType
    label: Key Role X Type
    description: "Chairman, Director. Found in 'Roles' in Specification/Resources"
    type: string
    size: 1
    example hex: 00
    example value: ""
    notes: ""

  - name: KeyRoleXName
    label: Key Role X Name
    description: "Name (eg. John Alexander Smith)"
    type: nvarchar8
    size: 14
    example hex: 0d4a616d65732042656c64696e67
    example value: "James Belding"
    notes: ""

  - name: NotableRolesCount
    label: Notable Roles Count
    description: "Number of notable roles associated with the issuing entity.  (eg. Corporate Officers, Managers, etc.) 0-255. 0 is valid."
    type: uint8
    size: 1
    example hex: 01
    example value: "1"
    notes: "Notable Roles - Amendments to Officer/Manager/etc. positions can be restricted to a vote.  No restrictions on changing other roles."

  - name: NotableRoleXType
    label: Notable Role X Type
    description: "Executives, Secretary, CEO, CTO, Managers, etc. Found in 'Roles' in Specification/Resources"
    type: string
    size: 3
    example hex: 43454f
    example value: "CEO"
    notes: ""

